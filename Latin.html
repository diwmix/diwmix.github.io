<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç</title>
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <div class="container">
        <h2 class="Greeting">–ó—Ä–æ–±–ª–µ–Ω–æ –¥–ª—è —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥—ñ–≤ –∑ –ª—é–±–æ–≤'—é ‚ù§Ô∏è <br> <span>üëâ <a href="https://instagram.com/diwmix">Inst: Diwmix</a> üëà</span> </h2>
        <div id="test-container"></div>
        <div class="result" id="result"></div>
        <button class="submit" onclick="submitTest()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
        <button class="down" onclick="scrollToBottom()">‚ñº</button>
    </div>

    <script>
        function scrollToBottom() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth' // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
            });
        }
        let shuffledTest = []; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
    
        async function fetchTestData() {
            try {
                const response = await fetch('BaseLatin.txt');
                const data = await response.text();
                return parseTestData(data);
            } catch (error) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–µ—Å—Ç—É:", error);
                return [];
            }
        }
    
        function parseTestData(data) {
            const questions = [];
            const lines = data.split('\n');
            let currentQuestion = null;
            const phrases = [
                '–ó–≤—É–∫', '–ë—É–∫–≤–æ—Å–ø–æ–ª—É—á–µ–Ω–Ω—è', '–ù–∞–∑–≤—ñ—Ç—å', '–õ–∞—Ç–∏–Ω—Å—å–∫–∞', '–õ–∞—Ç–∏–Ω—Å—å–∫–∏–π', 
                '–í–∏–±–µ—Ä—ñ—Ç—å', '–£–∑–≥–æ–¥—å—Ç–µ', '–Ø–∫', '–ó–∞–∑–Ω–∞—á—Ç–µ', '–û–±–µ—Ä—ñ—Ç—å', 
                '–ü–µ—Ä–µ–∫–ª–∞–¥—ñ—Ç—å', '–ó–Ω–∞–π–¥—ñ—Ç—å', '–£–∑–≥–æ–¥–∏—Ç–∏', '–ü–µ—Ä–µ–∫–ª–∞—Å—Ç–∏', '–í–∏–∑–Ω–∞—á—Ç–µ', 
                '–í–∏–±–µ—Ä—ñ—Ç—å', '–Ø–∫–µ', '–í–∏–∑–Ω–∞—á–∏—Ç–∏', '–°–ª–æ–≤–æ', '–ù–∞–≥–æ–ª–æ—Å', "–°–∫–ª–∞–¥–Ω—ñ", 
                '–£ —è–∫–æ–º—É', "–©–æ —Ç–∞–∫–µ", "–í–∏–±—Ä–∞—Ç–∏", "–ü—Ä–∏–≥–æ–ª–æ—Å–Ω–∏–π", "–í–∫–∞–∑–∞—Ç–∏ ", "–í–∫–∞–∂—ñ—Ç—å ", 
                "–ó–∞", '–ü—Ä–∏–∫–º–µ—Ç–Ω–∏–∫', '–í–∏–±–µ—Äi—Ç—å', '–§–æ—Ä–º–∞'
            ];
    
            for (const line of lines) {
                if (line.trim() === '--------------------' || line.trim() === '-------------------') {
                    continue;
                }
    
                if (phrases.some(phrase => line.trim().startsWith(phrase))) {
                    if (currentQuestion) questions.push(currentQuestion);  
                    currentQuestion = {
                        question: line.trim(),
                        answers: [],
                        correctAnswer: null
                    };
                } else if (line.trim().startsWith('+')) {
                    currentQuestion.correctAnswer = line.trim().substring(2).trim();
                    currentQuestion.answers.push(currentQuestion.correctAnswer);
                } else if (line.trim().length > 0) {
                    currentQuestion.answers.push(line.trim());
                }
            }
    
            if (currentQuestion) questions.push(currentQuestion);  
            return questions;
        }
    
        function shuffleArray(arr) {
            return arr.sort(() => Math.random() - 0.5);
        }
    
        function shuffleTestData(test) {
            const shuffledQuestions = shuffleArray(test);
            
            shuffledQuestions.forEach(question => {
                question.answers = shuffleArray(question.answers);
            });
    
            return shuffledQuestions;
        }
    
        async function displayTest() {
            const test = await fetchTestData();
            shuffledTest = shuffleTestData(test);  // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
            const container = document.getElementById('test-container');
            container.innerHTML = '';
    
            shuffledTest.forEach((item, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('question');
    
                const questionTitle = document.createElement('p');
                questionTitle.innerText = item.question;
                questionDiv.appendChild(questionTitle);
    
                const answersDiv = document.createElement('div');
                answersDiv.classList.add('answers');
    
                item.answers.forEach((answer, answerIndex) => {
                    const label = document.createElement('label');
                    const input = document.createElement('input');
                    input.type = 'radio';
                    input.name = `question${index}`;
                    input.value = answer;
    
                    input.addEventListener('change', () => showFeedback(input, item, questionDiv));
    
                    label.appendChild(input);
                    label.appendChild(document.createTextNode(answer));
                    answersDiv.appendChild(label);
                });
    
                questionDiv.appendChild(answersDiv);
                container.appendChild(questionDiv);
            });
        }
    
        function showFeedback(input, item, questionDiv) {
            const feedbackDiv = document.createElement('div');
            feedbackDiv.classList.add('feedback');
    
            const isCorrect = input.value === item.correctAnswer;
            if (isCorrect) {
                feedbackDiv.classList.add('correct');
                feedbackDiv.innerText = "–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å!";
            } else {
                feedbackDiv.classList.add('incorrect');
                feedbackDiv.innerText = `–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${item.correctAnswer}`;
            }
    
            const existingFeedback = questionDiv.querySelector('.feedback');
            if (existingFeedback) {
                existingFeedback.remove();
            }
            questionDiv.appendChild(feedbackDiv);
        }
    
        function submitTest() {
            let score = 0;
            const container = document.getElementById('test-container');
            container.querySelectorAll('.feedback').forEach(f => f.remove());
    
            shuffledTest.forEach((item, index) => {
                const selectedAnswer = document.querySelector(`input[name="question${index}"]:checked`);
                const feedbackDiv = document.createElement('div');
                feedbackDiv.classList.add('feedback');
    
                if (selectedAnswer) {
                    const isCorrect = selectedAnswer.value === item.correctAnswer;
                    if (isCorrect) {
                        feedbackDiv.classList.add('correct');
                        feedbackDiv.innerText = "–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å!";
                        score++;
                    } else {
                        feedbackDiv.classList.add('incorrect');
                        feedbackDiv.innerText = `–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${item.correctAnswer}`;
                    }
                } else {
                    feedbackDiv.classList.add('incorrect');
                    feedbackDiv.innerText = `–ù–µ –≤–∏–±—Ä–∞–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${item.correctAnswer}`;
                }
    
                const questionDiv = container.querySelectorAll('.question')[index];
                questionDiv.appendChild(feedbackDiv);
            });
    
            const resultDiv = document.getElementById('result');
            resultDiv.innerText = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${score} –∑ ${shuffledTest.length}`;
        }
    
        displayTest();
    </script>

</body>
</html>